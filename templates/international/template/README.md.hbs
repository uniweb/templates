# {{projectName}}

A multilingual business website built with [Uniweb](https://github.com/uniweb/cli) — a component web platform that separates content from code.

This template demonstrates internationalization (i18n), nested navigation with dropdowns, and active state highlighting.

## Features

- **Multilingual support** — English, Spanish, and French out of the box
- **Language switcher** — Header and footer components with locale navigation
- **Dropdown navigation** — Nested pages appear in dropdown menus
- **Active state highlighting** — Current page and parent pages are highlighted
- **SEO-friendly** — Proper `hreflang` tags and prerendered HTML per locale
- **Corporate structure** — Home, About, Services (with subpages), and Contact

{{> quick-start}}

## Project Structure

```
{{projectName}}/
├── foundation/          # Component library (React + Tailwind CSS v4)
│   ├── src/
│   │   ├── components/  # i18n-ready components (Hero, Features, etc.)
│   │   └── styles.css   # Tailwind theme
│   ├── vite.config.js   # defineFoundationConfig()
│   └── dist/            # Built output
│
├── site/                # Content site (markdown)
│   ├── layout/          # Layout panels
│   │   ├── header/      # Global header with language switcher
│   │   └── footer/      # Global footer with locale links
│   ├── pages/           # Content pages
│   │   ├── home/
│   │   ├── about/
│   │   ├── services/    # Parent page with nested children
│   │   │   ├── consulting/   # Child page
│   │   │   └── development/  # Child page
│   │   ├── blog/        # Article list + dynamic routes
│   │   │   └── [slug]/  # Individual article pages
│   │   └── contact/
│   ├── collections/     # Content collections (articles)
│   ├── locales/         # Translation files
│   │   ├── es.json, fr.json           # Hash-based page translations
│   │   ├── collections/               # Hash-based collection translations
│   │   │   ├── manifest.json
│   │   │   ├── es.json, fr.json
│   │   └── freeform/                  # Free-form section translations
│   │       ├── es/pages/about/story.md
│   │       └── fr/pages/about/story.md
│   ├── site.yml         # Site configuration with i18n settings
│   └── vite.config.js   # defineSiteConfig()
│
├── AGENTS.md            # AI assistant instructions
└── README.md            # This file
```

{{> components-docs}}

## Navigation Patterns

This template demonstrates several navigation features.

### Automatic Navigation Discovery

The Header component automatically discovers pages using `website.getPageHierarchy()`:

```jsx
const navPages = website.getPageHierarchy({ for: 'header' })
// Returns: [{ route, title, label, children: [...] }, ...]
```

Pages are included in navigation by default. Use `page.yml` to control visibility:

```yaml
# Hide from all navigation
hidden: true

# Hide from specific navigation areas
hideInHeader: true
hideInFooter: true
```

### Nested Pages and Dropdowns

Create nested pages by placing folders inside page folders:

```
pages/services/           # Parent: /services
├── page.yml
├── 1-hero.md
├── consulting/           # Child: /services/consulting
│   ├── page.yml
│   └── 1-hero.md
└── development/          # Child: /services/development
    ├── page.yml
    └── 1-hero.md
```

The Header automatically renders dropdowns for pages with children:
- **Desktop**: Hover to reveal dropdown menu
- **Mobile**: Expandable accordion for child pages

### Active State Highlighting

The Header uses `useActiveRoute()` from `@uniweb/kit` to highlight active pages:

```jsx
import { useActiveRoute } from '@uniweb/kit'

function NavItem({ page }) {
  const { isActive, isActiveOrAncestor } = useActiveRoute()

  // Exact match - highlights only current page
  const isCurrent = isActive(page)

  // Ancestor match - highlights parent when child is active
  const isInSection = isActiveOrAncestor(page)

  return (
    <Link className={isInSection ? 'text-primary font-semibold' : ''}>
      {page.title}
    </Link>
  )
}
```

**Active state behavior:**
- When on `/services/consulting`, both "Services" (parent) and "Consulting" (child) are highlighted
- Parent uses `isActiveOrAncestor()` to detect when any child is active
- Child uses `isActive()` for exact page match

### Page Labels

Use `label` in `page.yml` for shorter navigation text:

```yaml
title: Consulting Services    # Full title (used in <title> tag)
label: Consulting             # Short label (used in navigation)
```

{{> config-reference}}

## Content Authoring

Content lives in markdown files under `site/pages/`. Each section has:

```markdown
---
type: Hero
theme: gradient
layout: center
---

# Welcome to Our Company

We help businesses grow globally.

[Get Started](/contact)
[Learn More](/about)
```

Translatable strings are extracted automatically. The same content structure works across all locales.

{{> adding-pages}}

{{> search-docs}}

## i18n Workflow

Uniweb supports three translation approaches that can be used together:

| Approach | Best For | File Location |
|----------|----------|---------------|
| **Hash-based (pages)** | UI strings, short text, reusable phrases | `locales/{locale}.json` |
| **Hash-based (collections)** | Article titles, excerpts, tags, body text | `locales/collections/{locale}.json` |
| **Free-form** | Long-form content, sections needing creative rewording | `locales/freeform/{locale}/pages/...` |

### Commands

```bash
# Extract translatable strings from pages and collections
pnpm uniweb i18n extract

# Check translation coverage
pnpm uniweb i18n status

# Check free-form translation status (stale, orphaned)
pnpm uniweb i18n status --freeform

# Sync after content changes
pnpm uniweb i18n sync
```

### Hash-Based Translation (Pages)

Translation files in `site/locales/` map content hashes to localized text:

```json
{
  "a1b2c3": "Willkommen bei unserem Unternehmen",
  "d4e5f6": "Wir helfen Unternehmen, global zu wachsen."
}
```

Run `uniweb i18n extract` to generate the manifest with all translatable strings.

### Hash-Based Translation (Collections)

Collection data (articles, team members, etc.) has its own translation files in `locales/collections/`. The extraction runs automatically with `uniweb i18n extract` — no special flags needed.

**Translation structure:**
```
locales/collections/
├── manifest.json   # Extracted strings with hashes and context
├── es.json         # Spanish translations for collection data
└── fr.json         # French translations for collection data
```

**Workflow:**
1. Author collection items in `collections/` (e.g., `collections/articles/my-post.md`)
2. Build once to generate `public/data/` JSON: `pnpm build`
3. Extract: `pnpm uniweb i18n extract`
4. Translate hashes in `locales/collections/{locale}.json`
5. Build again — translated data is served at `/{locale}/data/articles.json`

The manifest includes context so translators know which collection and item each string belongs to:

```json
{
  "620d9c54": {
    "source": "Protecting Panda Habitats in Sichuan",
    "field": "title",
    "contexts": [{ "collection": "articles", "item": "habitat-protection" }]
  }
}
```

The runtime automatically fetches the correct locale-specific data — components don't need any special handling.

### Free-Form Translation (Complete Replacement)

For sections with longer content that benefit from creative rewording, use free-form translations. These replace the entire section content rather than translating element-by-element.

**Example structure:**
```
locales/freeform/
├── es/
│   ├── .manifest.json          # Staleness tracking
│   └── pages/about/story.md    # Complete Spanish version
└── fr/
    ├── .manifest.json
    └── pages/about/story.md    # Complete French version
```

Free-form translations also work for collection items:

```bash
# Initialize a free-form translation for a collection item
pnpm uniweb i18n init-freeform es collections/articles getting-started
```

**Creating a free-form translation:**
```bash
# Initialize from source content
pnpm uniweb i18n init-freeform es pages/about story

# Edit the generated file with your translation
# The file is a complete markdown section
```

**Managing free-form translations:**
```bash
# Check for stale translations (source changed)
pnpm uniweb i18n status --freeform

# Update hash after reviewing source changes
pnpm uniweb i18n update-hash es pages/about story

# Or update all stale at once
pnpm uniweb i18n update-hash es --all-stale

# Move translations when pages reorganize
pnpm uniweb i18n move pages/old-path pages/new-path

# Remove orphaned translations
pnpm uniweb i18n prune --freeform
```

This template includes free-form translations for the About page "story" section in Spanish and French, demonstrating how to use this feature for long-form content.

### Adding a New Locale

1. Edit `site/site.yml` to add the locale:
   ```yaml
   i18n:
     locales: [en, es, fr, de]  # Add 'de' for German
   ```
2. Create `site/locales/de.json` with hash-based translations
3. Create `site/locales/collections/de.json` for collection translations
4. Optionally create `site/locales/freeform/de/` for free-form translations
5. Run `pnpm build` to generate locale-specific pages

## Development

### Running Individual Packages

```bash
# Foundation dev server (component development)
pnpm --filter foundation dev

# Site dev server (content development)
pnpm --filter site dev
```

### Creating New Components

1. Create folder: `foundation/src/components/MyComponent/`
2. Add `index.jsx` with the React component
3. Add `meta.js` with metadata and parameters (see [meta.js guide](https://github.com/uniweb/cli/blob/main/docs/meta/README.md))
4. Rebuild: `cd foundation && pnpm build`

The `meta.js` file defines component parameters and content expectations. The runtime uses this metadata to apply defaults and guarantee content structure, eliminating defensive null checks in your component code.

See `AGENTS.md` for detailed component development guidelines.

{{> deployment}}

{{> ai-assistance}}

{{> learn-more}}

---

Built with the [Uniweb International Template](https://github.com/uniweb/templates)
