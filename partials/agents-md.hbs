# AGENTS.md

Instructions for AI assistants working with this Uniweb project.

## Project Overview

This is a **Uniweb** project — a component web platform that separates content from code. The project consists of:

- **Foundation** (`foundation/`) — React component library built with Vite
- **Site** (`site/`) — Content site using markdown files

Content authors write markdown. Components render it. Neither can break each other.

## Exploring the Codebase

### Finding Components

Components are auto-discovered from `foundation/src/components/*/meta.js`:

```bash
# List all components
ls foundation/src/components/

# Read component metadata
cat foundation/src/components/ComponentName/meta.js

# Read component implementation
cat foundation/src/components/ComponentName/index.jsx
```

### Understanding Content Structure

```bash
# See all pages
ls site/pages/

# Read page configuration
cat site/pages/pagename/page.yml

# Read page sections
cat site/pages/pagename/*.md
```

### Site Configuration

```bash
cat site/site.yml    # Site-wide settings (locales, index page, search)
```

## Component Metadata (meta.js)

Each component has a `meta.js` that defines its interface:

```javascript
export default {
  title: 'Component Name',
  description: 'What it does',
  category: 'content',

  // Content expectations
  content: {
    title: 'Main heading',
    paragraphs: 'Body text',
    items: 'List items from H3 headings',
  },

  // Configurable parameters
  params: {
    variant: {
      type: 'select',
      options: [{ value: 'default', label: 'Default' }],
      default: 'default',
    },
  },

  // Pre-configured combinations
  presets: {
    compact: {
      label: 'Compact',
      params: { variant: 'compact' },
    },
  },
}
```

## Content Authoring

### Section Files

Each markdown file in a page folder becomes a section:

```
site/pages/about/
├── page.yml          # Page config (title, layout)
├── 1-intro.md        # First section
├── 2-team.md         # Second section
└── 3-contact.md      # Third section
```

Files are ordered by filename prefix (1-, 2-, etc.).

### Markdown to Props

```markdown
---
type: ComponentName
paramName: value
---

### Eyebrow Text

# Main Title

## Subtitle

First paragraph becomes paragraphs[0].

Second paragraph becomes paragraphs[1].

### Item Title

Item paragraph.

![Image alt](image.jpg)

[Link text](url)
```

Maps to component props:

| Markdown | Props |
|----------|-------|
| H4 (####) before H3 | `pretitle` |
| H1 (#) | `title` |
| H2 (##) | `subtitle` |
| Paragraphs | `paragraphs[]` |
| H3 (###) sections | `subsections[]` or `items[]` |
| Images | `imgs[]` |
| Links | `links[]` |

### Special Pages

- `@header/` — Global header (appears on all pages)
- `@footer/` — Global footer (appears on all pages)

## Creating Components

### 1. Create the folder

```bash
mkdir -p foundation/src/components/MyComponent
```

### 2. Create meta.js

```javascript
// foundation/src/components/MyComponent/meta.js
export default {
  title: 'My Component',
  description: 'Does something useful',
  category: 'content',
  content: {
    title: 'Heading',
    paragraphs: 'Body text',
  },
  params: {},
  presets: {},
}
```

### 3. Create index.jsx

```jsx
// foundation/src/components/MyComponent/index.jsx
import React from 'react'

export function MyComponent({ content, params }) {
  const { title, paragraphs = [] } = content || {}

  return (
    <section className="py-12 px-6">
      {title && <h2>{title}</h2>}
      {paragraphs.map((p, i) => <p key={i}>{p}</p>)}
    </section>
  )
}

export default MyComponent
```

### 4. Rebuild foundation

```bash
cd foundation && pnpm build
```

Components are auto-discovered from `meta.js` — no manual registration needed.

## Common Tasks

### Add a new page

```bash
mkdir -p site/pages/newpage
echo "title: New Page" > site/pages/newpage/page.yml
```

### Add content to a page

Create a numbered markdown file:

```bash
cat > site/pages/newpage/1-content.md << 'EOF'
---
type: Text
---

# Page Title

Content here.
EOF
```

### Change site homepage

Edit `site/site.yml`:

```yaml
index: home  # Folder name that becomes /
```

### Enable search

Edit `site/site.yml`:

```yaml
search:
  enabled: true
```

## Imports

Components can import from these packages:

```javascript
// UI utilities and hooks
import { cn, Link, useWebsite } from '@uniweb/kit'

// Core classes (Website, Page, Block)
import { getUniweb } from '@uniweb/core'
```

## Development Commands

```bash
# Install dependencies
pnpm install

# Start dev server (both foundation + site)
pnpm dev

# Build for production
pnpm build

# Preview production build
pnpm preview
```

## Converting an Existing Design

When given a monolithic React/JSX file (e.g., a landing page built with an AI tool) to convert into a Uniweb project, follow this approach.

### Mindset

The goal is a page that **renders identically** to the original, but the implementation logic changes. You are not porting code line-by-line — you are decomposing a monolithic design into the Uniweb content/component architecture.

**Don't preserve source component names.** A monolithic file might have components named after specific content (e.g., `Institutions`, `ProximifyCTA`). Uniweb foundation components are **generic rendering agencies named for purpose**, not for the content they happen to display. A section showing an institutional quote is rendered by a component like `Testimonial` or `Quote` — something reusable for any quote, not tied to one client.

### Step 1: Identify Sections

Each visually distinct block in the design becomes:
- An **exposed component** in `foundation/src/components/` (with `meta.js`)
- A **markdown file** in `site/pages/` (with `type:` referencing that component)

Look for natural section boundaries — full-width blocks separated by spacing, background changes, or horizontal rules.

### Step 2: Separate Content from Code

For each section, ask: **what is content and what is design?**

| In the JSX source | In Uniweb |
|---|---|
| Hardcoded heading text | `# Heading` in markdown → `content.title` |
| Hardcoded paragraph text | Paragraph in markdown → `content.paragraphs[]` |
| Hardcoded link/button text and URLs | `[Label](url)` in markdown → `content.links[]` |
| Hardcoded images | `![Alt](path)` in markdown → `content.imgs[]` |
| Repeating card/item structures | H3 groups in markdown → `content.items[]` |
| Icon references (e.g., `lucide-react`) | `![](lu-iconname)` in markdown → `content.icons[]` |
| Layout, spacing, colors, animations | Component JSX + Tailwind classes |
| Visual elements with no content (diagrams, decorations) | Component JSX only — no markdown equivalent |

### Step 3: Name Components for Purpose

Choose names that describe **what the component does**, not what content it currently shows:

| Source name | Better Uniweb name | Why |
|---|---|---|
| `ProximifyCTA` | `CallToAction` | Renders any CTA, not just one brand's |
| `Institutions` | `Testimonial` or `Quote` | Renders any testimonial |
| `WorkModes` | `FeatureColumns` | Renders any set of features in columns |
| `TheModel` | `SplitContent` | Text on one side, visual on the other |

### Step 4: Design Params Beyond the Original

Exposed components should define **params in `meta.js`** that make them flexible, even if the original design only uses one variant. For example:

```javascript
// A component that's always "dark" in the source design
// should still support theme switching
params: {
  theme: {
    type: 'select',
    options: ['light', 'dark'],
    default: 'dark',  // Matches the original design
  },
  align: {
    type: 'select',
    options: ['left', 'center'],
    default: 'center',
  },
}
```

The original design becomes the **default preset**. But a content author can reconfigure.

### Step 5: Create Internal Components

Not every React component in the source becomes an exposed Uniweb component. Shared UI elements like buttons, cards, and badges are **internal components** — they live in `foundation/src/shared/` (or similar) with **no `meta.js`**:

```
foundation/src/
├── components/          # Exposed (with meta.js) — selectable from markdown
│   ├── Hero/
│   ├── FeatureGrid/
│   └── CallToAction/
├── shared/              # Internal (no meta.js) — used by exposed components
│   ├── Button.jsx
│   ├── Badge.jsx
│   └── SectionWrapper.jsx
└── styles.css
```

Internal components are imported by exposed components but are invisible to content authors. This is normal and encouraged — it keeps the content interface clean.

### Step 6: Map Special Sections

| Source pattern | Uniweb equivalent |
|---|---|
| Navigation / navbar | `@header/` special page with a Header component |
| Footer | `@footer/` special page with a Footer component |
| Sticky/fixed elements | Header component using `useScrolled()` hook |
| Mobile menu toggle | Header component using `useMobileMenu()` hook |

### Step 7: Extract Design Tokens

Colors, fonts, and spacing from the source become Tailwind theme variables:

```css
/* foundation/src/styles.css */
@import "tailwindcss";
@source "./components/**/*.jsx";
@source "./shared/**/*.jsx";
@source "../node_modules/@uniweb/kit/src/**/*.jsx";

@theme {
  --color-primary: #0f172a;      /* From the source's main color */
  --color-accent: #10b981;       /* From the source's accent color */
}
```

### Example: Converting a Landing Page

Given a file with `Nav`, `Hero`, `Features`, `Testimonial`, `CTA`, `Footer`:

**Foundation components created:**
- `Hero/` — full-width hero with heading, text, buttons
- `FeatureGrid/` — grid of feature cards with icons
- `Testimonial/` — quote with attribution
- `CallToAction/` — dark-background CTA section
- `Header/` — navigation bar (for `@header`)
- `Footer/` — site footer (for `@footer`)

**Internal helpers:**
- `shared/Button.jsx` — reusable button styles
- `shared/SectionWrapper.jsx` — consistent section padding/width

**Site content:**
```
site/pages/
├── @header/
│   └── 1-nav.md           # type: Header
├── @footer/
│   └── 1-footer.md        # type: Footer (links as markdown)
└── home/
    ├── page.yml
    ├── 1-hero.md           # type: Hero
    ├── 2-features.md       # type: FeatureGrid (items from H3 groups)
    ├── 3-testimonial.md    # type: Testimonial
    └── 4-cta.md            # type: CallToAction
```

## Troubleshooting

### Component not appearing

1. Check `meta.js` exists in component folder
2. Rebuild foundation: `cd foundation && pnpm build`
3. Check browser console for errors

### Content not rendering

1. Verify `type:` in frontmatter matches component name exactly
2. Check markdown structure matches component's content expectations
3. Look at `meta.js` to understand expected content format

### Styles not working

1. Foundation uses Tailwind CSS v4
2. Check `foundation/src/styles.css` for theme configuration
3. Rebuild after CSS changes
